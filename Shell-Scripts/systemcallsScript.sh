#!/bin/bash

#systemcallsScript.sh

#this script executes different commands with strace 
#in order to show their systemcalls

#usage ./systemcallsScript.sh

echo -e "\n\n---------------------------------------------------------------"
echo -e "executing strace with: \nrm, mv, chnmod, chown, mkdir, rmdir, kill, ln, sleep, wget"
echo -e "---------------------------------------------------------------"



echo -e "\n\n---------------------------------------------------------------"
echo -e "rm"
echo -e "---------------------------------------------------------------"
touch test
strace rm test



echo -e "\n\n---------------------------------------------------------------"
echo -e "mv"
echo -e "---------------------------------------------------------------"
touch test123
strace mv test123 test456



echo -e "\n\n---------------------------------------------------------------"
echo -e "chmod"
echo -e "---------------------------------------------------------------"
strace chmod 777 test456



echo -e "\n\n---------------------------------------------------------------"
echo -e "chown"
echo -e "---------------------------------------------------------------"
strace chown hans test456



echo -e "\n\n---------------------------------------------------------------"
echo -e "mkdir"
echo -e "---------------------------------------------------------------"
strace mkdir testDir



echo -e "\n\n---------------------------------------------------------------"
echo -e "rmdir"
echo -e "---------------------------------------------------------------"
strace rmdir testDir



echo -e "\n\n---------------------------------------------------------------"
echo -e "kill"
echo -e "---------------------------------------------------------------"
xeyes&
sleep 1
PID=$(pgrep xeyes)
strace kill $PID  



echo -e "\n\n---------------------------------------------------------------"
echo -e "ln"
echo -e "---------------------------------------------------------------"
strace ln test456 testlink



echo -e "\n\n---------------------------------------------------------------"
echo -e "sleep"
echo -e "---------------------------------------------------------------"
strace sleep 1 



echo -e "\n\n---------------------------------------------------------------"
echo -e "wget"
echo -e "---------------------------------------------------------------"
strace wget #some link to a jpg
#2>&1 | grep -E "socket|connect|sendto|recvfrom"
#2>&1 | tail -n 30 



echo -e "\n\n---------------------------------------------------------------"
echo -e "delete temporary files..."
echo -e "---------------------------------------------------------------"
rm test456
rm testlink
rm *.jpg
